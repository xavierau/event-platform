| Task ID     | Description                                                                                             | Complexity | Dependencies                     | Status  | Remarks                                                                                                                              |
|-------------|---------------------------------------------------------------------------------------------------------|------------|----------------------------------|---------|--------------------------------------------------------------------------------------------------------------------------------------|
| **PHASE 1: CORE INFRASTRUCTURE** | | | | | |
| CPN-001     | Create migrations for `coupons`, `user_coupons`, and `coupon_usage_logs` tables.                       | Medium     |                                  | Done    | Schema defined with types, limits, validity periods, and relationships. Located in `database/migrations/Modules/Coupon`.         |
| CPN-002     | Implement Eloquent Models: `Coupon`, `UserCoupon`, `CouponUsageLog`.                                     | Medium     | CPN-001                          | Done | Include relationships (`belongsTo`, `hasMany`), casts for enums/dates, and necessary traits.                                           |
| CPN-003     | Implement Enums: `CouponTypeEnum` (`SINGLE_USE`, `MULTI_USE`), `UserCouponStatusEnum` (`ACTIVE`, `FULLY_USED`, `EXPIRED`). | Low        |                                  | Done | Place in `app/Modules/Coupon/Enums`.                                                                                                 |
| CPN-004     | Implement DTOs: `CouponData`, `IssueCouponData`.                                                        | Medium     | CPN-003                          | Done | Use `spatie/laravel-data`. Include validation rules for creating/updating coupons and for issuing them to users.                     |
| CPN-005     | Write Unit/Feature tests for all Models to ensure relationships and scopes work correctly.              | Medium     | CPN-002                          | Done | TDD approach.                                                                                                                        |
| **PHASE 2: BUSINESS LOGIC** | | | | | |
| CPN-006     | Implement Action: `UpsertCouponAction` for creating/updating `Coupon` templates.                        | Medium     | CPN-002, CPN-004                 | Pending | Re-implement action and tests. Handles create/update operations for coupon templates.                                              |
| **CPN-007: Issue Coupon Logic (Broken Down)** | | | | | |
| CPN-007a    | Test & implement coupon issuance eligibility validation.                                               | Low        | CPN-006                          | Pending | Re-implement validation with 10 tests covering all validation scenarios (dates, limits, user eligibility).                        |
| CPN-007b    | Test & implement unique code generation for UserCoupon.                                                | Low        | CPN-007a                         | Pending | Re-implement QR-code optimized generation, collision handling, and performance tests.                                              |
| CPN-007c    | Test & implement single coupon issuance to user.                                                       | Medium     | CPN-007b                         | Pending | Re-implement with 10 tests. Handles SINGLE_USE vs MULTI_USE logic, integrates eligibility validation and unique code generation. |
| CPN-007d    | Test & implement bulk coupon issuance (multiple copies to one user).                                   | Medium     | CPN-007c                         | Pending | Re-implement with 10 tests including performance testing. Efficient batch processing with collision handling and limit validation.|
| CPN-007e    | Integrate and test complete `IssueCouponToUserAction`.                                                  | Low        | CPN-007d                         | Pending | Re-implement unified action routing to single/bulk actions based on quantity. Maintains consistent behavior.                      |
| **CPN-008: Redeem Coupon Logic (Broken Down)** | | | | | |
| CPN-008a    | Test & implement coupon lookup by unique code.                                                         | Low        | CPN-007e                         | Pending | Find UserCoupon by unique_code. Handle not found scenarios.                                                                         |
| CPN-008b    | Test & implement coupon validation (active, not expired, usage limits).                                | Medium     | CPN-008a                         | Pending | Check status, expiry dates, usage counts. Return detailed validation results.                                                       |
| CPN-008c    | Test & implement usage increment and status updates.                                                   | Low        | CPN-008b                         | Pending | Increment times_used, update status to FULLY_USED when appropriate.                                                                 |
| CPN-008d    | Test & implement CouponUsageLog creation.                                                              | Low        | CPN-008c                         | Pending | Log redemption with timestamp, location, user details.                                                                              |
| CPN-008e    | Integrate and test complete `RedeemUserCouponAction`.                                                   | Low        | CPN-008d                         | Pending | Combine all redemption logic into atomic transaction.                                                                               |
| CPN-009     | Implement Service: `CouponService` to provide a public API for the module.                              | Medium     | CPN-008e                         | Pending | Exposes clean methods like `redeemCoupon`, `validateCoupon`, `issueCoupon`, etc., to be used by controllers.                           |
| **CPN-010: Comprehensive Testing (Broken Down)** | | | | | |
| CPN-010a    | Write unit tests for all Action classes (success paths).                                               | Medium     | CPN-009                          | Pending | Test each action in isolation with mocked dependencies.                                                                             |
| CPN-010b    | Write unit tests for all Action classes (validation failures).                                         | Medium     | CPN-010a                         | Pending | Test invalid inputs, business rule violations.                                                                                      |
| CPN-010c    | Write unit tests for all Action classes (edge cases).                                                  | Medium     | CPN-010b                         | Pending | Test expired coupons, max usage scenarios, concurrent redemptions.                                                                  |
| CPN-010d    | Write integration tests for CouponService.                                                             | Medium     | CPN-010c                         | Pending | Test service orchestration, cross-action workflows.                                                                                 |
| CPN-010e    | Write feature tests for end-to-end coupon workflows.                                                   | Medium     | CPN-010d                         | Pending | Test complete user journeys: issue → validate → redeem.                                                                             |
| **PHASE 3: PRESENTATION LAYER** | | | | | |
| CPN-011     | Create `Admin/CouponController` for Organizer/Admin CRUD of `Coupon` templates.                         | Medium     | CPN-009                          | Pending | Secure endpoints with appropriate authorization (e.g., policies).                                                                    |
| **CPN-012: Admin UI Development (Broken Down)** | | | | | |
| CPN-012a    | Create Coupon Index page (listing with filters).                                                       | Medium     | CPN-011                          | Pending | Vue/Inertia page showing all coupons with search, filter by status/type.                                                            |
| CPN-012b    | Create Coupon Create/Edit form component.                                                              | Medium     | CPN-012a                         | Pending | Reusable form component handling validation, translatable fields.                                                                   |
| CPN-012c    | Create Coupon Show/Detail page.                                                                        | Medium     | CPN-012b                         | Pending | Display coupon details, usage statistics, issued coupons list.                                                                      |
| CPN-012d    | Create bulk issuance interface.                                                                        | Medium     | CPN-012c                         | Pending | UI for issuing coupons to multiple users or user groups.                                                                            |
| CPN-012e    | Add coupon management to main admin navigation.                                                        | Low        | CPN-012d                         | Pending | Integrate coupon section into existing admin layout.                                                                                |
| CPN-013     | Create `Api/V1/CouponScannerController` for the QR reader.                                              | Medium     | CPN-009                          | Pending | Should have a `show($uniqueCode)` for validation and a `store($uniqueCode)` to confirm redemption.                                    |
| **CPN-014: QR Scanner Interface (Broken Down)** | | | | | |
| CPN-014a    | Create basic QR scanner page layout (mobile-first).                                                    | Medium     | CPN-013                          | Pending | Responsive layout optimized for mobile devices.                                                                                     |
| CPN-014b    | Integrate QR code reading functionality.                                                               | Medium     | CPN-014a                         | Pending | Use existing QR scanner components or implement new one.                                                                            |
| CPN-014c    | Create coupon validation display (before redemption).                                                  | Medium     | CPN-014b                         | Pending | Show coupon details, validity status, allow user to confirm redemption.                                                             |
| CPN-014d    | Create redemption confirmation interface.                                                              | Medium     | CPN-014c                         | Pending | Success/error feedback, option to scan next coupon.                                                                                 |
| CPN-014e    | Add offline capability and error handling.                                                             | Medium     | CPN-014d                         | Pending | Handle network errors, provide clear feedback for scan failures.                                                                    |
| CPN-015     | Create `User/MyCouponsController` to display a user's wallet.                                           | Medium     | CPN-009                          | Pending | Fetches all valid `UserCoupon` instances for the authenticated user.                                                                 |
| CPN-016     | Develop "My Coupons" page for users to view their coupons.                                              | Medium     | CPN-015                          | Pending | A section in the user's dashboard showing their coupons, usage, and expiry dates.                                                    |
| **PHASE 4: INTEGRATION & FINALIZATION** | | | | | |
| CPN-017     | Create `CouponPolicy` to manage permissions.                                                            | Medium     | CPN-002                          | Pending | Define who can create, update, delete, and view coupons.                                                                             |
| CPN-018     | Implement Seeders for `Coupon` and `UserCoupon` for testing and demo purposes.                          | Medium     | CPN-002                          | Pending | Create realistic sample data.                                                                                                        | 
| **PHASE 5: ENHANCED FEATURES** | | | | | |
| CPN-019     | Implement Exception classes for coupon-specific errors.                                                | Low        | CPN-002                          | Pending | `CouponExpiredException`, `CouponAlreadyUsedException`, `InvalidCouponException`.                                                     |
| CPN-020     | Add coupon-event integration logic.                                                                     | Medium     | CPN-009                          | Pending | Link coupons to specific events, venue restrictions.                                                                                |
| CPN-021     | Implement coupon expiry notification system.                                                           | Medium     | CPN-009                          | Pending | Notify users of expiring coupons, organizers of usage stats.                                                                        |
| CPN-022     | Integration tests with existing Event/Venue systems.                                                   | Medium     | CPN-020                          | Pending | Test cross-module functionality, ensure system coherence.                                                                           | 
