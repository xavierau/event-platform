import{d as J,s as H,C as R,c as W,a as u,o as m,b as r,e,m as X,w as l,f as a,t as c,P as I,g as n,p as K,F as g,r as y,j as Y,k as v,v as Z,E as ee,l as w,i as te}from"./app-ByQyqBS_.js";import{_ as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-DQAcQT4Q.js";import{_ as x}from"./index-CgpMGGsi.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-BxnTNpf2.js";import{_}from"./Input.vue_vue_type_script_setup_true_lang-ZKJD8WZY.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-DGumchS6.js";import{_ as V,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-CzaPD53W.js";import{_ as U,a as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-InQRUi0p.js";import{c as re,g as $}from"./i18n-Y5fp0i2u.js";import"./index-f7ZDSE-M.js";import"./useForwardPropsEmits-BMF7lwx-.js";import"./useForwardExpose-Cm5UNL-Y.js";import"./useFocusGuards-DbLdHL-X.js";import"./Teleport-CdpgOwT1.js";import"./VisuallyHidden-D1GZ7jD7.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-DU-I71e0.js";import"./RovingFocusGroup-B7He9Lbd.js";import"./createLucideIcon-BMrOxxBw.js";import"./x-BzXsbRZC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CpED-Kne.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useToast-KxfFLkHg.js";const oe={class:"py-12"},ae={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},le={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-xl sm:rounded-lg"},se={class:"p-6 lg:p-8 bg-white dark:bg-gray-800 dark:bg-gradient-to-bl dark:from-gray-700/50 dark:via-transparent border-b border-gray-200 dark:border-gray-700"},ne={class:"flex justify-between items-center mb-6"},de={class:"text-2xl font-medium text-gray-900 dark:text-white"},ue={class:"border-b border-gray-200 dark:border-gray-700 mb-4"},me={class:"-mb-px flex space-x-8","aria-label":"Tabs"},fe=["onClick"],pe={class:"space-y-6 mt-4"},ce=["id","onUpdate:modelValue"],_e=["value"],ge=["value"],ye={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ke=["value"],be={key:0},we={class:"mt-6 flex justify-end space-x-4"},Ie=J({__name:"Edit",props:{ticketDefinition:{},statuses:{},availableLocales:{},timezones:{},eventOccurrences:{},errors:{}},setup(Q){var M,z,E,O,S,j,q,P,A,B,N,F;const s=Q,L=H(re.value||Object.keys(s.availableLocales)[0]||"en"),b=H(L.value),o=R({_method:"PUT",name:{},description:{},price:typeof((M=s.ticketDefinition)==null?void 0:M.price)=="number"&&s.ticketDefinition.price!==null?s.ticketDefinition.price/100:void 0,currency:((z=s.ticketDefinition)==null?void 0:z.currency)||"HKD",total_quantity:((E=s.ticketDefinition)==null?void 0:E.total_quantity)??void 0,status:((O=s.ticketDefinition)==null?void 0:O.status)??(((j=(S=s.statuses)==null?void 0:S[0])==null?void 0:j.value)||"draft"),availability_window_start:((q=s.ticketDefinition)==null?void 0:q.availability_window_start)||"",availability_window_end:((P=s.ticketDefinition)==null?void 0:P.availability_window_end)||"",min_per_order:((A=s.ticketDefinition)==null?void 0:A.min_per_order)??1,max_per_order:((B=s.ticketDefinition)==null?void 0:B.max_per_order)??void 0,timezone:((N=s.ticketDefinition)==null?void 0:N.timezone)??null,event_occurrence_ids:((F=s.ticketDefinition)==null?void 0:F.event_occurrence_ids)??[]});s.availableLocales&&Object.keys(s.availableLocales).forEach(d=>{var t,i;o.name[d]=$((t=s.ticketDefinition)==null?void 0:t.name,d)||"",o.description[d]=$((i=s.ticketDefinition)==null?void 0:i.description,d)||""});const h=W(()=>{var d;return((d=s.statuses)==null?void 0:d.map(t=>({value:t.value,label:t.label})))??[]}),C=W(()=>Object.entries(s.availableLocales||{}).map(([d,t])=>({key:d,label:t}))),G=()=>{var d;if(!((d=s.ticketDefinition)!=null&&d.id)){alert("Ticket definition ID is missing. Cannot update.");return}o.transform(t=>({...t,price:typeof t.price=="number"&&t.price!==null?Math.round(t.price*100):t.price})).post(route("admin.ticket-definitions.update",s.ticketDefinition.id),{onSuccess:()=>{alert("Ticket definition updated successfully.")},onError:t=>{console.error("Update Error:",t);const i=Object.values(t).join(`
`);alert(i||"Please check the form for errors.")}})};return(d,t)=>(m(),u(g,null,[r(e(X),{title:"Edit Ticket Definition"}),r(ie,null,{default:l(()=>[a("div",oe,[a("div",ae,[a("div",le,[a("div",se,[a("div",ne,[a("h1",de," Edit Ticket Definition: "+c(e($)(s.ticketDefinition.name,L.value)),1),r(e(I),{href:d.route("admin.ticket-definitions.index")},{default:l(()=>[r(e(x),{variant:"outline"},{default:l(()=>t[10]||(t[10]=[n("Back to List")])),_:1})]),_:1},8,["href"])]),t[27]||(t[27]=a("p",{class:"-mt-4 mb-6 text-sm text-gray-700 dark:text-gray-300"}," Modify the details of this ticket definition. ",-1)),a("form",{onSubmit:K(G,["prevent"])},[r(e(V),{class:"mb-6"},{default:l(()=>[r(e(U),null,{default:l(()=>[r(e(T),null,{default:l(()=>t[11]||(t[11]=[n("Translatable Information")])),_:1})]),_:1}),r(e(D),{class:"py-5 px-6"},{default:l(()=>[a("div",ue,[a("nav",me,[(m(!0),u(g,null,y(C.value,i=>(m(),u("button",{key:i.key,onClick:K(k=>b.value=i.key,["prevent"]),class:Y([b.value===i.key?"border-indigo-500 text-indigo-600 dark:border-indigo-400 dark:text-indigo-300":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600","whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm focus:outline-none"])},c(i.label),11,fe))),128))])]),(m(!0),u(g,null,y(C.value,i=>v((m(),u("div",{key:i.key},[a("div",pe,[a("div",null,[r(e(f),{for:`name_${i.key}`},{default:l(()=>[n("Name ("+c(i.label)+")",1)]),_:2},1032,["for"]),r(e(_),{id:`name_${i.key}`,type:"text",modelValue:e(o).name[i.key],"onUpdate:modelValue":k=>e(o).name[i.key]=k,class:"mt-1 block w-full"},null,8,["id","modelValue","onUpdate:modelValue"]),r(p,{message:e(o).errors[`name.${i.key}`],class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:`description_${i.key}`},{default:l(()=>[n("Description ("+c(i.label)+")",1)]),_:2},1032,["for"]),v(a("textarea",{id:`description_${i.key}`,"onUpdate:modelValue":k=>e(o).description[i.key]=k,rows:"4",class:"mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,8,ce),[[Z,e(o).description[i.key]]]),r(p,{message:e(o).errors[`description.${i.key}`],class:"mt-1"},null,8,["message"])])])])),[[ee,b.value===i.key]])),128))]),_:1})]),_:1}),r(e(V),{class:"mb-6"},{default:l(()=>[r(e(U),null,{default:l(()=>[r(e(T),null,{default:l(()=>t[12]||(t[12]=[n("Basic Information")])),_:1})]),_:1}),r(e(D),{class:"space-y-6"},{default:l(()=>[a("div",null,[r(e(f),{for:"price"},{default:l(()=>t[13]||(t[13]=[n("Price")])),_:1}),r(e(_),{id:"price",type:"number",step:"0.01",modelValue:e(o).price,"onUpdate:modelValue":t[0]||(t[0]=i=>e(o).price=i),modelModifiers:{number:!0},placeholder:"e.g., 10.00"},null,8,["modelValue"]),r(p,{message:e(o).errors.price,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"currency"},{default:l(()=>t[14]||(t[14]=[n("Currency")])),_:1}),r(e(_),{id:"currency",type:"text",modelValue:e(o).currency,"onUpdate:modelValue":t[1]||(t[1]=i=>e(o).currency=i),placeholder:"e.g., USD",maxlength:"3"},null,8,["modelValue"]),r(p,{message:e(o).errors.currency,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"total_quantity"},{default:l(()=>t[15]||(t[15]=[n("Quantity Available (leave blank for unlimited)")])),_:1}),r(e(_),{id:"total_quantity",type:"number",modelValue:e(o).total_quantity,"onUpdate:modelValue":t[2]||(t[2]=i=>e(o).total_quantity=i),modelModifiers:{number:!0},placeholder:"e.g., 100"},null,8,["modelValue"]),r(p,{message:e(o).errors.total_quantity,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"status"},{default:l(()=>t[16]||(t[16]=[n("Status")])),_:1}),v(a("select",{id:"status","onUpdate:modelValue":t[3]||(t[3]=i=>e(o).status=i),class:"mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[(m(!0),u(g,null,y(h.value,i=>(m(),u("option",{key:i.value,value:i.value},c(i.label),9,_e))),128))],512),[[w,e(o).status]]),r(p,{message:e(o).errors.status,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"timezone"},{default:l(()=>t[17]||(t[17]=[n("Timezone")])),_:1}),v(a("select",{id:"timezone","onUpdate:modelValue":t[4]||(t[4]=i=>e(o).timezone=i),class:"mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[t[18]||(t[18]=a("option",{value:null},"-- Select Timezone (uses server default) --",-1)),(m(!0),u(g,null,y(s.timezones,i=>(m(),u("option",{key:i,value:i},c(i),9,ge))),128))],512),[[w,e(o).timezone]]),r(p,{message:e(o).errors.timezone,class:"mt-1"},null,8,["message"])]),a("div",ye,[a("div",null,[r(e(f),{for:"availability_window_start"},{default:l(()=>t[19]||(t[19]=[n("Availability Window Start (Local Time)")])),_:1}),r(e(_),{id:"availability_window_start",type:"datetime-local",modelValue:e(o).availability_window_start,"onUpdate:modelValue":t[5]||(t[5]=i=>e(o).availability_window_start=i)},null,8,["modelValue"]),r(p,{message:e(o).errors.availability_window_start,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"availability_window_end"},{default:l(()=>t[20]||(t[20]=[n("Availability Window End (Local Time)")])),_:1}),r(e(_),{id:"availability_window_end",type:"datetime-local",modelValue:e(o).availability_window_end,"onUpdate:modelValue":t[6]||(t[6]=i=>e(o).availability_window_end=i)},null,8,["modelValue"]),r(p,{message:e(o).errors.availability_window_end,class:"mt-1"},null,8,["message"])])]),a("div",ve,[a("div",null,[r(e(f),{for:"min_per_order"},{default:l(()=>t[21]||(t[21]=[n("Min Per Order")])),_:1}),r(e(_),{id:"min_per_order",type:"number",modelValue:e(o).min_per_order,"onUpdate:modelValue":t[7]||(t[7]=i=>e(o).min_per_order=i),modelModifiers:{number:!0},placeholder:"Default: 1",min:"1"},null,8,["modelValue"]),r(p,{message:e(o).errors.min_per_order,class:"mt-1"},null,8,["message"])]),a("div",null,[r(e(f),{for:"max_per_order"},{default:l(()=>t[22]||(t[22]=[n("Max Per Order (optional)")])),_:1}),r(e(_),{id:"max_per_order",type:"number",modelValue:e(o).max_per_order,"onUpdate:modelValue":t[8]||(t[8]=i=>e(o).max_per_order=i),modelModifiers:{number:!0},placeholder:"e.g., 10",min:"1"},null,8,["modelValue"]),r(p,{message:e(o).errors.max_per_order,class:"mt-1"},null,8,["message"])])])]),_:1})]),_:1}),r(e(V),{class:"mb-6"},{default:l(()=>[r(e(U),null,{default:l(()=>[r(e(T),null,{default:l(()=>t[23]||(t[23]=[n("Event Associations")])),_:1})]),_:1}),r(e(D),{class:"space-y-6"},{default:l(()=>[a("div",null,[r(e(f),{for:"event_occurrence_ids"},{default:l(()=>t[24]||(t[24]=[n("Associated Event Occurrences (optional)")])),_:1}),v(a("select",{id:"event_occurrence_ids","onUpdate:modelValue":t[9]||(t[9]=i=>e(o).event_occurrence_ids=i),multiple:"",class:"mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",size:"6"},[(m(!0),u(g,null,y(s.eventOccurrences,i=>(m(),u("option",{key:i.id,value:i.id},[n(c(i.event_name)+" - "+c(i.name)+" ",1),i.start_at?(m(),u("span",be,"("+c(i.start_at)+")",1)):te("",!0)],8,ke))),128))],512),[[w,e(o).event_occurrence_ids]]),r(p,{message:e(o).errors.event_occurrence_ids,class:"mt-1"},null,8,["message"]),t[25]||(t[25]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Hold Ctrl/Cmd to select multiple occurrences. Leave empty to make this ticket available for all events. ",-1))])]),_:1})]),_:1}),a("div",we,[r(e(I),{href:d.route("admin.ticket-definitions.index")},{default:l(()=>[r(e(x),{type:"button",variant:"outline"},{default:l(()=>t[26]||(t[26]=[n("Cancel")])),_:1})]),_:1},8,["href"]),r(e(x),{type:"submit",disabled:e(o).processing},{default:l(()=>[n(c(e(o).processing?"Saving...":"Update Ticket Definition"),1)]),_:1},8,["disabled"])])],32)])])])])]),_:1})],64))}});export{Ie as default};
