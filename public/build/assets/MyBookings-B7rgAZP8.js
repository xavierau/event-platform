import{a,o as n,f as t,d as E,t as i,j as Y,e as y,b as $,n as A,s as D,c as Q,B as V,x as z,i as p,p as q,g as F,F as C,r as j,m as P,w as N,P as T,W as G,h as L}from"./app-CBcdSYGl.js";import{d as u}from"./dayjs.min-Byr-DLKl.js";import{u as I}from"./utc-BTAAoPZS.js";import{u as W}from"./useCurrency-BssAE4dZ.js";import{a as S,g as U,c as H,e as O}from"./qrcode-CiPJzAB6.js";import{Q as J}from"./browser-_tJ77kRx.js";import{_ as K}from"./FrontendFooter.vue_vue_type_script_setup_true_lang-C-uE7akA.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";function tt(w,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"})])}const et={class:"flex justify-between items-start h-full"},st={class:"flex-1 min-w-0 pr-4"},ot={class:"flex items-start flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-2 sm:space-y-0 mb-3"},nt={class:"text-base font-medium text-gray-900 dark:text-gray-100 leading-tight"},at={class:"space-y-2"},rt={class:"text-sm text-gray-600 dark:text-gray-400 break-all"},it={class:"ml-1"},lt={class:"text-sm text-gray-600 dark:text-gray-400"},dt={class:"ml-1"},gt={class:"flex-shrink-0 text-right flex flex-col justify-between h-full min-h-[80px]"},ct={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-2"},ut={class:"text-sm text-gray-500 dark:text-gray-400 mt-auto flex items-center justify-end"},mt=E({__name:"BookingItem",props:{booking:{}},emits:["showDetails"],setup(w,{emit:v}){const l=w,x=v,{formatPrice:h}=W();function b(r,m){return r===0?"Free":h(r,m)}function k(){x("showDetails",l.booking)}return(r,m)=>{var _;return n(),a("div",{class:"px-6 py-6 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors duration-200 min-h-[120px]",onClick:k},[t("div",et,[t("div",st,[t("div",ot,[t("h4",nt,i(((_=r.booking.ticket_definition)==null?void 0:_.name)||"General Admission"),1),t("span",{class:Y(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",y(S)(r.booking.status)])},i(y(U)(r.booking.status)),3)]),t("div",at,[t("p",rt,[m[0]||(m[0]=t("span",{class:"font-medium dark:text-gray-300"},"Booking #:",-1)),t("span",it,i(r.booking.booking_number),1)]),t("p",lt,[m[1]||(m[1]=t("span",{class:"font-medium dark:text-gray-300"},"Booked on:",-1)),t("span",dt,i(y(u)(r.booking.created_at).format("MMM DD, YYYY")),1)])])]),t("div",gt,[t("p",ct,i(b(r.booking.total_price,r.booking.currency)),1),t("div",ut,[$(y(tt),{class:"h-10 w-10 text-gray-500 dark:text-gray-400"})])])])])}}}),ft={key:0,class:"p-6"},yt={class:"text-center mb-6"},vt={class:"bg-gray-50 rounded-lg p-4 inline-block"},kt={key:0,class:"w-64 h-64 flex items-center justify-center"},xt=["src"],pt={key:2,class:"w-64 h-64 flex items-center justify-center text-gray-500"},ht={key:0,class:"flex items-center justify-center mt-2 text-xs text-gray-500"},bt={class:"space-y-4"},_t={class:"flex items-start justify-between"},wt={class:"flex-1"},Mt={class:"text-lg font-medium text-gray-900"},$t={key:0,class:"bg-gray-50 rounded-lg p-4"},Dt={class:"text-sm text-gray-700 mb-1"},Bt={key:0,class:"mt-3"},Ct={class:"space-y-2"},Yt={class:"font-medium"},jt={key:0,class:"flex items-center mt-1"},Rt={class:"bg-gray-50 rounded-lg p-4"},Qt={class:"space-y-2 text-sm"},Ft={class:"flex justify-between"},Et={class:"font-mono text-gray-900 text-xs"},Zt={class:"flex justify-between"},Nt={class:"text-gray-900"},Tt={class:"flex justify-between"},It={class:"text-gray-900 font-medium"},St={class:"flex justify-between"},Ut={class:"text-gray-900"},At={class:"bg-blue-50 rounded-lg p-4"},Vt={class:"text-xs text-blue-700"},zt=E({__name:"BookingDetailsModal",props:{showModal:{type:Boolean},booking:{}},emits:["close","refreshBookings"],setup(w,{emit:v}){u.extend(I);const l=w,x=v,h=A(),b=D(""),k=D(!1),r=D(null),m=Q(()=>{var e;return(e=h.props.auth)==null?void 0:e.user}),_=async()=>{if(!(!l.booking||!m.value)){k.value=!0;try{const e=H(m.value.id,l.booking.booking_number,l.booking.id),s=O(e),f=await J.toDataURL(s,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});b.value=f}catch(e){console.error("Error generating QR code:",e)}finally{k.value=!1}}},R=()=>{r.value&&clearInterval(r.value),r.value=setInterval(()=>{l.showModal&&l.booking&&_()},6e4)},B=()=>{r.value&&(clearInterval(r.value),r.value=null)};V(()=>l.showModal,e=>{e&&l.booking?(_(),R()):B()});function g(e,s){if(!e)return"Date TBD";const f=u(e),c=s?u(s):null;return c&&!f.isSame(c,"day")?`${f.format("MMM DD")} - ${c.format("MMM DD, YYYY")}`:f.format("MMM DD, YYYY ‚Ä¢ h:mm A")}function o(){B(),x("refreshBookings"),x("close")}function d(e){e.target===e.currentTarget&&o()}return z(()=>{B()}),(e,s)=>{var f,c,Z;return e.showModal?(n(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:d},[t("div",{class:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:s[0]||(s[0]=q(()=>{},["stop"]))},[t("div",{class:"flex justify-between items-center p-6 border-b border-gray-200"},[s[2]||(s[2]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Booking Details",-1)),t("button",{onClick:o,class:"text-gray-400 hover:text-gray-600 transition-colors"},s[1]||(s[1]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e.booking?(n(),a("div",ft,[t("div",yt,[t("div",vt,[k.value?(n(),a("div",kt,s[3]||(s[3]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)]))):b.value?(n(),a("img",{key:1,src:b.value,alt:"Booking QR Code",class:"w-64 h-64"},null,8,xt)):(n(),a("div",pt," Failed to generate QR code "))]),s[5]||(s[5]=t("p",{class:"text-sm text-gray-600 mt-2"}," Show this QR code for check-in ",-1)),k.value?(n(),a("div",ht,s[4]||(s[4]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-3 w-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Refreshing QR code... ")]))):p("",!0)]),t("div",bt,[t("div",_t,[t("div",wt,[t("h3",Mt,i(((f=e.booking.ticket_definition)==null?void 0:f.name)||"General Admission"),1),t("span",{class:Y(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mt-1",y(S)(e.booking.status)])},i(y(U)(e.booking.status)),3)])]),e.booking.event?(n(),a("div",$t,[s[8]||(s[8]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Event Details",-1)),t("p",Dt,i(e.booking.event.name),1),(c=e.booking.event_occurrences)!=null&&c.length?(n(),a("div",Bt,[s[7]||(s[7]=t("p",{class:"text-xs font-medium text-gray-600 mb-2"},"Valid for:",-1)),t("div",Ct,[(n(!0),a(C,null,j(e.booking.event_occurrences,M=>(n(),a("div",{key:M.id,class:"text-xs text-gray-600"},[t("div",Yt,i(M.name||"Event Date"),1),t("div",null,i(g(M.start_at,M.end_at)),1),M.venue_name?(n(),a("div",jt,[s[6]||(s[6]=t("span",{class:"mr-1"},"üìç",-1)),t("span",null,i(M.venue_name),1)])):p("",!0)]))),128))])])):p("",!0)])):p("",!0),t("div",Rt,[s[13]||(s[13]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Booking Information",-1)),t("div",Qt,[t("div",Ft,[s[9]||(s[9]=t("span",{class:"text-gray-600"},"Booking Number:",-1)),t("span",Et,i(e.booking.booking_number),1)]),t("div",Zt,[s[10]||(s[10]=t("span",{class:"text-gray-600"},"Quantity:",-1)),t("span",Nt,i(e.booking.quantity),1)]),t("div",Tt,[s[11]||(s[11]=t("span",{class:"text-gray-600"},"Total Price:",-1)),t("span",It,i(e.booking.total_price===0?"Free":`${(Z=e.booking.currency)==null?void 0:Z.toUpperCase()} ${(e.booking.total_price/100).toFixed(2)}`),1)]),t("div",St,[s[12]||(s[12]=t("span",{class:"text-gray-600"},"Booked on:",-1)),t("span",Ut,i(y(u)(e.booking.created_at).format("MMM DD, YYYY")),1)])])]),t("div",At,[s[14]||(s[14]=t("h4",{class:"font-medium text-blue-900 mb-2"},"QR Code Information",-1)),t("p",Vt," This QR code contains encrypted booking information and is valid for check-in. The QR code refreshes automatically every minute for enhanced security. Generated at "+i(y(u)().format("MMM DD, YYYY ‚Ä¢ h:mm A"))+". ",1)])])])):p("",!0),t("div",{class:"flex justify-end space-x-3 p-6 border-t border-gray-200"},[t("button",{onClick:o,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Close ")])])])):p("",!0)}}}),qt={class:"min-h-screen bg-gray-100 dark:bg-gray-900"},Pt={class:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50 border-b dark:border-gray-700"},Gt={class:"container mx-auto flex items-center p-4 relative"},Lt={class:"container mx-auto py-6 px-4 pb-24"},Wt={class:"mb-6"},Ht={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"},Ot={class:"flex space-x-2 text-sm flex-wrap"},Jt={key:0},Kt={class:"space-y-6"},Xt={class:"px-6 py-5 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},te={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1"},ee={key:0,class:"mt-4"},se={class:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3"},oe={class:"font-medium text-gray-900 dark:text-gray-100 text-sm"},ne={class:"text-sm text-gray-600 dark:text-gray-300 mt-1"},ae={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2 flex items-center"},re={class:"truncate"},ie={class:"divide-y divide-gray-200 dark:divide-gray-700"},le={key:1,class:"text-center py-12"},de={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-8"},ge={class:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2"},ce={key:0},ue={key:1},me={key:2},fe={class:"text-gray-600 dark:text-gray-300 mb-6"},ye={key:0},ve={key:1},ke={key:2},xe=E({__name:"MyBookings",props:{bookings:{type:Array,default:()=>[]}},setup(w){u.extend(I);const v=w,l=D("upcoming"),x=D(!1),h=D(null),b=Q(()=>{if(!v.bookings)return[];const g=u().utc();switch(l.value){case"upcoming":return v.bookings.filter(o=>{var d;return(d=o.event_occurrences)!=null&&d.length?o.event_occurrences.some(e=>e.start_at&&u(e.start_at).utc().isAfter(g)):!0});case"past":return v.bookings.filter(o=>{var d;return(d=o.event_occurrences)!=null&&d.length?o.event_occurrences.every(e=>e.start_at&&u(e.start_at).utc().isBefore(g)):!1});case"all":default:return v.bookings}}),k=Q(()=>{const g={};return b.value.forEach(o=>{var s;const e=((s=o.event)==null?void 0:s.name)||"Unknown Event";g[e]||(g[e]=[]),g[e].push(o)}),g});function r(g){l.value=g}function m(g,o){if(!g)return"Date TBD";const d=u(g),e=o?u(o):null;return e&&!d.isSame(e,"day")?`${d.format("MMM DD")} - ${e.format("MMM DD, YYYY")}`:d.format("MMM DD, YYYY ‚Ä¢ h:mm A")}function _(g){h.value=g,x.value=!0}function R(){x.value=!1,h.value=null}function B(){G.reload({only:["bookings"]})}return(g,o)=>(n(),a(C,null,[$(y(P),{title:"My Bookings"}),t("div",qt,[t("header",Pt,[t("div",Gt,[$(y(T),{href:"/",class:"text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 absolute left-4"},{default:N(()=>o[3]||(o[3]=[F(" ‚Üê Back ")])),_:1}),o[4]||(o[4]=t("h1",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100 flex-1 text-center"},"My Bookings",-1))])]),t("main",Lt,[t("section",Wt,[t("div",Ht,[o[5]||(o[5]=t("h2",{class:"text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-4 sm:mb-0"},"Your Tickets",-1)),t("div",Ot,[t("button",{onClick:o[0]||(o[0]=d=>r("upcoming")),class:Y(["px-3 py-1 rounded-full font-medium",l.value==="upcoming"?"bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-indigo-200":"text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"])}," Upcoming ",2),t("button",{onClick:o[1]||(o[1]=d=>r("past")),class:Y(["px-3 py-1 rounded-full font-medium",l.value==="past"?"bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-indigo-200":"text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"])}," Past Events ",2),t("button",{onClick:o[2]||(o[2]=d=>r("all")),class:Y(["px-3 py-1 rounded-full font-medium",l.value==="all"?"bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-indigo-200":"text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"])}," All Bookings ",2)])])]),Object.keys(k.value).length>0?(n(),a("section",Jt,[t("div",Kt,[(n(!0),a(C,null,j(k.value,(d,e)=>{var s,f;return n(),a("div",{key:e,class:"bg-white dark:bg-gray-800 rounded-lg shadow"},[t("div",Xt,[t("h3",te,i(e),1),(f=(s=d[0])==null?void 0:s.event_occurrences)!=null&&f.length?(n(),a("div",ee,[o[7]||(o[7]=t("div",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"Valid for the following dates:",-1)),t("div",se,[(n(!0),a(C,null,j(d[0].event_occurrences,c=>(n(),a("div",{key:c.id,class:"bg-white dark:bg-gray-700 rounded-lg p-3 border border-gray-200 dark:border-gray-600 shadow-sm"},[t("div",oe,i(c.name||"Event Date"),1),t("div",ne,i(m(c.start_at,c.end_at)),1),c.venue_name?(n(),a("div",ae,[o[6]||(o[6]=t("span",{class:"mr-1"},"üìç",-1)),t("span",re,i(c.venue_name),1)])):p("",!0)]))),128))])])):p("",!0)]),t("div",ie,[(n(!0),a(C,null,j(d,c=>(n(),L(mt,{key:c.id,booking:c,onShowDetails:_},null,8,["booking"]))),128))])])}),128))])])):(n(),a("section",le,[t("div",de,[o[9]||(o[9]=t("div",{class:"text-6xl mb-4"},"üé´",-1)),t("h3",ge,[l.value==="upcoming"?(n(),a("span",ce,"No upcoming bookings")):l.value==="past"?(n(),a("span",ue,"No past bookings")):(n(),a("span",me,"No bookings found"))]),t("p",fe,[l.value==="upcoming"?(n(),a("span",ye,"You don't have any upcoming events. Discover amazing events to attend!")):l.value==="past"?(n(),a("span",ve,"You haven't attended any events yet.")):(n(),a("span",ke,"You haven't made any bookings yet. Start exploring events!"))]),$(y(T),{href:"/",class:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800"},{default:N(()=>o[8]||(o[8]=[F(" Browse Events ")])),_:1})])]))]),$(K),$(zt,{"show-modal":x.value,booking:h.value,onClose:R,onRefreshBookings:B},null,8,["show-modal","booking"])])],64))}}),Be=X(xe,[["__scopeId","data-v-829d580e"]]);export{Be as default};
