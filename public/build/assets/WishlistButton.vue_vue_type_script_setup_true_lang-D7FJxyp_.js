const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-_LMAJuVE.js","assets/app-Bgt9kZxD.css"])))=>i.map(i=>d[i]);
import{s as w,c as u,W as m,d as L,n as I,z as $,a as b,o as x,e as A,j as _,i as j,f as F,t as N,bX as O}from"./app-_LMAJuVE.js";function B(){const n=w(!1),h=w(null),s=w([]),l=w(0),i=w({}),c=()=>{h.value=null},p=()=>{var t,r;try{const e=window.$page,o=(r=(t=e==null?void 0:e.props)==null?void 0:t.auth)==null?void 0:r.user;return console.log("isAuthenticated",o,e),o?!0:(m.visit(route("login")),!1)}catch{return m.visit(route("login")),!1}},f=t=>{var r,e;console.error("Wishlist API error:",t),(e=(r=t.response)==null?void 0:r.data)!=null&&e.message?h.value=t.response.data.message:t.message?h.value=t.message:h.value="An unexpected error occurred"},v=async t=>{var r;if(!p())return!1;n.value=!0,c();try{const e=await fetch("/wishlist",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({event_id:t})}),o=await e.json();if(!e.ok){if(e.status===401)return m.visit(route("login")),!1;throw new Error(o.message||"Failed to add to wishlist")}return i.value[t]=!0,!0}catch(e){return f(e),!1}finally{n.value=!1}},k=async t=>{var r;if(!p())return!1;n.value=!0,c();try{const e=await fetch(`/wishlist/${t}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}}),o=await e.json();if(!e.ok){if(e.status===401)return m.visit(route("login")),!1;throw new Error(o.message||"Failed to remove from wishlist")}return i.value[t]=!1,s.value=s.value.filter(a=>a.id!==t),l.value=Math.max(0,l.value-1),!0}catch(e){return f(e),!1}finally{n.value=!1}},E=async t=>{var r;n.value=!0,c();try{const e=await fetch(`/wishlist/${t}/toggle`,{method:"PUT",headers:{"X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}}),o=await e.json();if(!e.ok){if(e.status===401)return m.visit(route("login")),null;throw new Error(o.message||"Failed to toggle wishlist")}const{added:a,in_wishlist:d}=o.data;return i.value[t]=d||!1,a||(s.value=s.value.filter(y=>y.id!==t),l.value=Math.max(0,l.value-1)),{added:a||!1,inWishlist:d||!1}}catch(e){return f(e),null}finally{n.value=!1}},C=async t=>{var r;try{const e=await fetch(`/wishlist/${t}/check`,{method:"GET",headers:{"X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}}),o=await e.json();if(!e.ok){if(e.status===401)return!1;throw new Error(o.message||"Failed to check wishlist status")}const a=o.data.in_wishlist||!1;return i.value[t]=a,a}catch(e){return console.warn("Failed to check wishlist status:",e),!1}},g=async()=>{var t;n.value=!0,c();try{const r=await fetch("/wishlist",{method:"GET",headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}}),e=await r.json();if(!r.ok){if(r.status===401)return m.visit(route("login")),[];throw new Error(e.message||"Failed to get wishlist")}return s.value=e.data.wishlist||[],l.value=e.data.count||0,s.value.forEach(o=>{i.value[o.id]=!0}),s.value}catch(r){return f(r),[]}finally{n.value=!1}},T=async()=>{var t;n.value=!0,c();try{const r=await fetch("/wishlist",{method:"DELETE",headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}}),e=await r.json();if(!r.ok){if(r.status===401)return m.visit(route("login")),!1;throw new Error(e.message||"Failed to clear wishlist")}return s.value=[],l.value=0,i.value={},!0}catch(r){return f(r),!1}finally{n.value=!1}},W=t=>i.value[t]||!1;return{isLoading:u(()=>n.value),error:u(()=>h.value),wishlistItems:u(()=>s.value),wishlistCount:u(()=>l.value),addToWishlist:v,removeFromWishlist:k,toggleWishlist:E,checkWishlistStatus:C,getUserWishlist:g,clearWishlist:T,isInWishlist:W,clearError:c}}const R=["disabled","title"],X=["fill","d"],q={key:2},M=L({__name:"WishlistButton",props:{eventId:{},variant:{default:"button"},size:{default:"md"},showText:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},emits:["wishlistChanged","error"],setup(n,{emit:h}){const s=n,l=h,{isLoading:i,error:c,toggleWishlist:p,checkWishlistStatus:f,isInWishlist:v,clearError:k}=B(),E=w(!1),C=I(),g=u(()=>{var a;return!!((a=C.props.auth)!=null&&a.user)});$(async()=>{console.log("isAuthenticated.value",g.value),g.value&&await f(s.eventId),E.value=!0});const T=async()=>{if(s.disabled||i.value)return;if(!g.value){const{router:d}=await O(async()=>{const{router:y}=await import("./app-_LMAJuVE.js").then(S=>S.bZ);return{router:y}},__vite__mapDeps([0,1]));d.visit(route("login"));return}k();const a=await p(s.eventId);a?l("wishlistChanged",a.inWishlist):c.value&&l("error",c.value)},W=u(()=>{const a="inline-flex items-center justify-center transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",d={button:"border rounded-full font-semibold",icon:"rounded-full",text:"underline-offset-4 hover:underline"},y={sm:s.variant==="button"?"px-3 py-1.5 text-xs":s.variant==="icon"?"p-1.5 text-sm":"text-xs",md:s.variant==="button"?"px-4 py-2 text-sm":s.variant==="icon"?"p-2 text-base":"text-sm",lg:s.variant==="button"?"px-6 py-3 text-base":s.variant==="icon"?"p-3 text-lg":"text-base"},S=v(s.eventId)?{button:"border-red-500 bg-red-500 text-white hover:bg-red-600 focus:ring-red-500",icon:"text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 focus:ring-red-500",text:"text-red-500 hover:text-red-600 focus:ring-red-500"}:{button:"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:ring-gray-500",icon:"text-gray-400 hover:text-red-500 hover:bg-gray-50 dark:hover:bg-gray-700 focus:ring-gray-500",text:"text-gray-600 dark:text-gray-400 hover:text-red-500 focus:ring-gray-500"},z=s.disabled||i.value?"opacity-50 cursor-not-allowed":"cursor-pointer";return`${a} ${d[s.variant]} ${y[s.size]} ${S[s.variant]} ${z}`}),t=u(()=>`${{sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[s.size]} ${s.showText&&s.variant==="button"?"mr-2":""}`),r=u(()=>s.showText?i.value?"Loading...":g.value?v(s.eventId)?"In Wishlist":"Add to Wishlist":"Login to Save":""),e=u(()=>(v(s.eventId),"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z")),o=u(()=>v(s.eventId)?"currentColor":"none");return(a,d)=>(x(),b("button",{class:_(W.value),disabled:a.disabled||A(i),onClick:T,title:g.value?A(v)(a.eventId)?"Remove from wishlist":"Add to wishlist":"Login to save to wishlist"},[A(i)?(x(),b("svg",{key:0,class:_([t.value,"animate-spin"]),fill:"none",viewBox:"0 0 24 24"},d[0]||(d[0]=[F("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),F("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]),2)):(x(),b("svg",{key:1,class:_(t.value),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[F("path",{fill:o.value,"stroke-linecap":"round","stroke-linejoin":"round",d:e.value},null,8,X)],2)),a.showText&&a.variant==="button"?(x(),b("span",q,N(r.value),1)):j("",!0)],10,R))}});export{M as _,B as u};
