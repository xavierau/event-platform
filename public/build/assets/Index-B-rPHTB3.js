import{d as G,c as F,a as n,i as c,o as r,f as e,g as p,t as o,j as O,e as b,F as H,r as Q,b as E,w as R,k as W,A as le,n as ie,s as u,C as de,B as ce,z as ue,x as ve,m as me,l as ge,h as ke}from"./app-_LMAJuVE.js";import{_ as U}from"./index-CyzG3B7Q.js";import{g as J,a as ye,d as be,i as fe}from"./qrcode-CiPJzAB6.js";import{d as B}from"./dayjs.min-BYdALWVn.js";import{U as pe,_ as he}from"./vue-qrcode-reader-D2amrEiW.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-BmACvFIT.js";import"./index-DskH3tKn.js";import"./useForwardPropsEmits-mgxhVe2d.js";import"./useForwardExpose-DvgX0o-v.js";import"./useFocusGuards-_TrNIUuM.js";import"./Teleport-sQDXNy6f.js";import"./VisuallyHidden-BEO5d0G6.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-43_aYyr-.js";import"./RovingFocusGroup-DvsoFtKQ.js";import"./createLucideIcon-BM0PkPLY.js";import"./x-BMJwbN6X.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CmZdlobI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useToast-BEKNO1yO.js";const _e={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},we={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800"},Ce={class:"mt-3"},Se={class:"flex items-center justify-between mb-4"},Ee={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ie={class:"space-y-1 text-sm"},$e={class:"space-y-1 text-sm"},Ae={class:"bg-blue-50 dark:bg-blue-900 rounded-lg p-4 mb-4"},Ne={class:"space-y-1 text-sm"},Re={key:0},Me={key:0,class:"bg-yellow-50 dark:bg-yellow-900 rounded-lg p-4 mb-4"},Pe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Te={class:"text-center"},Oe={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Fe={class:"text-center"},He={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Ue={class:"text-center"},Ye={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},je={class:"text-center"},Be={class:"text-2xl font-bold text-gray-600 dark:text-gray-400"},Qe={key:0,class:"space-y-2"},Le={class:"max-h-32 overflow-y-auto space-y-1"},qe={class:"flex items-center space-x-2"},Ve={class:"text-gray-600 dark:text-gray-400"},ze={key:0,class:"text-gray-500 dark:text-gray-400 text-right"},Xe={key:1,class:"text-sm text-gray-600 dark:text-gray-400"},Ke={key:1,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Je={class:"space-y-2 max-h-48 overflow-y-auto"},Ge=["value"],We={class:"ml-3 text-sm text-gray-700 dark:text-gray-200"},Ze={class:"font-medium"},et={key:0,class:"block text-xs text-gray-500 dark:text-gray-400"},tt={key:0,class:"text-xs text-red-500 mt-1"},st={key:1,class:"text-xs text-yellow-600 mt-1"},at={key:2,class:"bg-yellow-50 dark:bg-yellow-700 border border-yellow-300 dark:border-yellow-600 rounded-md text-sm text-yellow-700 dark:text-yellow-200 p-3"},rt={class:"flex justify-end space-x-3 p-5 border-t border-gray-200 dark:border-gray-700"},nt={key:0},ot={key:1},lt={key:2},it={key:3},dt=G({__name:"QRCodeBookingDetailsModal",props:{show:{type:Boolean},bookingDetails:{},checkInHistory:{},eventOccurrences:{},selectedOccurrenceId:{},checkInStatus:{},isProcessing:{type:Boolean},checkInFormErrors:{}},emits:["close","check-in","update:selectedOccurrenceId"],setup(L,{emit:q}){const i=L,_=F({get:()=>i.selectedOccurrenceId,set:t=>k("update:selectedOccurrenceId",t)}),k=q,v=t=>ye(t),A=(t,s)=>new Intl.NumberFormat("en-US",{style:"currency",currency:s||"USD"}).format(t/100),D=(t,s)=>{if(!t)return"Date TBD";const y=B(t),m=s?B(s):null;return m&&!y.isSame(m,"day")?`${y.format("MMM D, HH:mm")} - ${m.format("MMM D, HH:mm, YYYY")}`:y.format("MMM D, YYYY • HH:mm")},g=t=>B(t).format("MMM D, YYYY • HH:mm"),I=t=>{switch(t){case"SUCCESSFUL":return"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100";case"FAILED_MAX_USES_REACHED":return"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100";case"FAILED_ALREADY_USED":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100"}},h=t=>{switch(t){case"SUCCESSFUL":return"Successful";case"FAILED_MAX_USES_REACHED":return"Max Uses Reached";case"FAILED_ALREADY_USED":return"Already Used";case"FAILED_INVALID_CODE":return"Invalid Code";case"FAILED_NOT_YET_VALID":return"Not Yet Valid";case"FAILED_EXPIRED":return"Expired";default:return t}};return(t,s)=>{var y,m;return t.show&&t.bookingDetails?(r(),n("div",_e,[e("div",we,[e("div",Ce,[e("div",Se,[s[5]||(s[5]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Booking Details",-1)),e("button",{onClick:s[0]||(s[0]=l=>t.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},s[4]||(s[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Ee,[e("div",De,[e("div",null,[s[10]||(s[10]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Booking Information",-1)),e("div",Ie,[e("div",null,[s[6]||(s[6]=e("span",{class:"font-medium"},"Booking #:",-1)),p(" "+o(t.bookingDetails.booking_number),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"font-medium"},"Status:",-1)),e("span",{class:O(v(t.bookingDetails.status))},o(b(J)(t.bookingDetails.status)),3)]),e("div",null,[s[8]||(s[8]=e("span",{class:"font-medium"},"Quantity:",-1)),p(" "+o(t.bookingDetails.quantity),1)]),e("div",null,[s[9]||(s[9]=e("span",{class:"font-medium"},"Total:",-1)),p(" "+o(A(t.bookingDetails.total_price,t.bookingDetails.currency)),1)])])]),e("div",null,[s[13]||(s[13]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Customer Information",-1)),e("div",$e,[e("div",null,[s[11]||(s[11]=e("span",{class:"font-medium"},"Name:",-1)),p(" "+o(t.bookingDetails.user.name),1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"font-medium"},"Email:",-1)),p(" "+o(t.bookingDetails.user.email),1)])])])])]),e("div",Ae,[s[16]||(s[16]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Event Information",-1)),e("div",Ne,[e("div",null,[s[14]||(s[14]=e("span",{class:"font-medium"},"Event:",-1)),p(" "+o(t.bookingDetails.event.name),1)]),t.bookingDetails.ticket_definition?(r(),n("div",Re,[s[15]||(s[15]=e("span",{class:"font-medium"},"Ticket Type:",-1)),p(" "+o(t.bookingDetails.ticket_definition.name),1)])):c("",!0)])]),t.checkInHistory?(r(),n("div",Me,[s[22]||(s[22]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-3"},"Check-in History & Usage",-1)),e("div",Pe,[e("div",Te,[e("div",Oe,o(t.checkInHistory.successful_check_ins),1),s[17]||(s[17]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Successful",-1))]),e("div",Fe,[e("div",He,o(t.checkInHistory.failed_check_ins),1),s[18]||(s[18]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Failed",-1))]),e("div",Ue,[e("div",Ye,o(t.checkInHistory.remaining_check_ins),1),s[19]||(s[19]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Remaining",-1))]),e("div",je,[e("div",Be,o(t.checkInHistory.max_allowed_check_ins),1),s[20]||(s[20]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Max Allowed",-1))])]),t.checkInHistory.check_in_logs.length>0?(r(),n("div",Qe,[s[21]||(s[21]=e("h5",{class:"font-medium text-gray-900 dark:text-gray-100 text-sm"},"Recent Check-in Attempts:",-1)),e("div",Le,[(r(!0),n(H,null,Q(t.checkInHistory.check_in_logs.slice(0,5),l=>(r(),n("div",{key:l.id,class:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded text-xs"},[e("div",qe,[e("span",{class:O([I(l.status),"px-2 py-1 rounded-full text-xs font-medium"])},o(h(l.status)),3),e("span",Ve,o(g(l.timestamp)),1)]),l.event_occurrence?(r(),n("div",ze,[e("div",null,o(l.event_occurrence.name||"Main Occurrence"),1)])):c("",!0)]))),128))])])):(r(),n("div",Xe," No previous check-in attempts found. "))])):c("",!0),t.eventOccurrences.length>0?(r(),n("div",Ke,[s[24]||(s[24]=e("h5",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Select Event Occurrence for Check-in:",-1)),e("div",Je,[(r(!0),n(H,null,Q(t.eventOccurrences,l=>(r(),n("label",{key:l.id,class:O(["flex items-center p-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors",{"bg-indigo-50 dark:bg-indigo-900 border border-indigo-500 dark:border-indigo-400":_.value===l.id}])},[W(e("input",{type:"radio",name:"event_occurrence",value:l.id,"onUpdate:modelValue":s[1]||(s[1]=M=>_.value=M),class:"form-radio h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-500 focus:ring-indigo-500"},null,8,Ge),[[le,_.value]]),e("span",We,[e("span",Ze,o(l.name||"Main Occurrence"),1),s[23]||(s[23]=e("br",null,null,-1)),p(" "+o(D(l.start_at,l.end_at))+" ",1),l.venue_name?(r(),n("span",et,"📍 "+o(l.venue_name),1)):c("",!0)])],2))),128))]),!_.value&&((y=t.checkInFormErrors)!=null&&y.event_occurrence_id)?(r(),n("p",tt,o(t.checkInFormErrors.event_occurrence_id),1)):!_.value&&t.bookingDetails.status==="confirmed"&&!t.checkInStatus?(r(),n("p",st,"Please select an occurrence to proceed with check-in.")):c("",!0)])):(r(),n("div",at," No upcoming occurrences found for this event. Check-in may not be possible. ")),t.checkInStatus?(r(),n("div",{key:3,class:O(["mt-4 p-3 rounded-md text-sm",{"bg-green-50 dark:bg-green-700 border border-green-300 dark:border-green-600 text-green-700 dark:text-green-200":t.checkInStatus.success,"bg-red-50 dark:bg-red-700 border border-red-300 dark:border-red-600 text-red-700 dark:text-red-200":!t.checkInStatus.success}])},o(t.checkInStatus.message),3)):c("",!0)]),e("div",rt,[E(U,{variant:"outline",onClick:s[2]||(s[2]=l=>t.$emit("close"))},{default:R(()=>s[25]||(s[25]=[p("Cancel")])),_:1}),E(U,{variant:"default",onClick:s[3]||(s[3]=l=>t.$emit("check-in")),disabled:!_.value||t.isProcessing&&!t.checkInStatus||t.bookingDetails.status!=="confirmed"||((m=t.checkInStatus)==null?void 0:m.success)===!0},{default:R(()=>{var l;return[t.isProcessing&&!t.checkInStatus?(r(),n("span",nt,"Processing Check-in...")):((l=t.checkInStatus)==null?void 0:l.success)===!0?(r(),n("span",ot,"Checked In")):t.bookingDetails.status!=="confirmed"?(r(),n("span",lt,"Cannot Check-In (Status: "+o(b(J)(t.bookingDetails.status))+")",1)):(r(),n("span",it,"Confirm Check-in"))]}),_:1},8,["disabled"])])])])):c("",!0)}}}),ct={class:"py-12"},ut={class:"mx-auto max-w-4xl sm:px-6 lg:px-8"},vt={class:"bg-white p-6 shadow-sm sm:rounded-lg dark:bg-gray-800"},mt={key:0,class:"mb-6"},gt={value:null},kt=["value"],yt={key:0,class:"mt-1 text-sm text-yellow-600"},bt={key:1,class:"mt-1 text-sm text-blue-600"},ft={key:1,class:"mb-4 border-l-4 border-yellow-400 bg-yellow-50 p-4 text-yellow-700"},pt={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},ht={class:"relative aspect-square min-h-[300px] overflow-hidden rounded-lg border border-gray-300 md:aspect-auto dark:border-gray-600"},xt={key:0,class:"bg-red-100 p-4 text-sm text-red-700"},_t={key:0,class:"mt-1"},wt={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700"},Ct={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700"},St={class:"p-4 text-center text-gray-500 dark:text-gray-400"},Et={key:0},Dt={key:1},It={class:"space-y-4"},$t={class:"rounded-md border border-blue-200 bg-blue-50 p-3 text-xs dark:border-blue-700 dark:bg-blue-900"},At={class:"space-y-1 text-blue-800 dark:text-blue-200"},Nt={key:0,class:"flex items-center text-sm text-gray-600 dark:text-gray-400"},Rt={key:1,class:"rounded-md border border-green-300 bg-green-50 p-3 text-sm text-green-700 dark:border-green-600 dark:bg-green-700 dark:text-green-200"},Mt={key:2,class:"rounded-md border border-red-300 bg-red-50 p-3 text-sm text-red-700 dark:border-red-600 dark:bg-red-700 dark:text-red-200"},Pt={key:3,class:"text-sm text-gray-500 dark:text-gray-400"},Tt={key:4,class:"text-sm text-gray-500 dark:text-gray-400"},Ot={key:0},Ft={key:1},Ht={key:2},Ut={class:"mt-6 flex justify-between"},ns=G({__name:"Index",setup(L){var K;const i=ie().props,_=u(!1),k=u(null),v=u(null),A=u([]),D=u(null),g=u(null),I=u(null),h=u(null),t=u(!1),s=u(!1),y=u(!1),m=u(null),l=u(0),M=u(null),Y=u(!1),V=u(!1),z=u(!1),X=u(!1),Z=u(""),f=F(()=>i.user_role==="admin"),C=F(()=>i.user_role==="admin"),P=F(()=>C.value?!0:!f.value&&i.events.length>0?i.events.length===1||g.value!==null:!1),N=de({qr_code_identifier:"",event_occurrence_id:null,method:"QR_SCAN",operator_user_id:(K=i.auth.user)==null?void 0:K.id});ce(g,()=>{j()});const ee=async d=>{var x;if(t.value||d.length===0)return;const a=d[0].rawValue;y.value=!0,t.value=!0,k.value=null,v.value=null,A.value=[],D.value=null,m.value=null;try{let S=a;try{const T=be(a);if(!fe(T,24*30)){k.value={error:"QR code has expired or is invalid."},y.value=!1,t.value=!1;return}S=T.bookingNumber}catch(T){console.warn("Failed to decode QR code data:",T),S=a}M.value=a;const w=await fetch(route("admin.qr-scanner.validate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content,Accept:"application/json"},body:JSON.stringify({qr_code:S,event_id:g.value})}),$=await w.json();w.ok&&$.success?(v.value=$.booking,A.value=$.event_occurrences,D.value=$.check_in_history,k.value={success:`Booking ${$.booking.booking_number} found.`},N.qr_code_identifier=$.booking.booking_number,y.value=!1,s.value=!0):(k.value={error:$.message||"Failed to validate QR code."},v.value=null,y.value=!1)}catch(S){console.error("Error processing QR code:",S),k.value={error:S.message||"Error processing QR code."},v.value=null,y.value=!1}finally{t.value=!1}},te=d=>{let a=`Camera error: ${d.name}`;switch(d.name){case"NotAllowedError":a="Camera access denied. Please allow camera access in your browser settings and refresh the page.";break;case"NotFoundError":a="No camera found. Please ensure a camera is connected to your device.";break;case"NotReadableError":a="Camera is already in use by another application. Please close other apps using the camera.";break;case"OverconstrainedError":a="Camera constraints could not be satisfied. Try refreshing the page.";break;case"SecurityError":a="Camera access blocked due to security restrictions. Ensure you are on HTTPS.";break;case"AbortError":a="Camera access was aborted. Please try again.";break;default:a=`Camera error: ${d.name}. ${d.message||"Please ensure camera access is allowed."}`}h.value=a},se=()=>{_.value=!0,h.value=null},j=async()=>{k.value=null,v.value=null,A.value=[],D.value=null,I.value=null,m.value=null,t.value=!1,s.value=!1,y.value=!1,M.value=null,h.value=null,Y.value=!0,await new Promise(d=>setTimeout(d,100)),Y.value=!1,N.reset(),N.qr_code_identifier="",!C.value&&(f.value&&i.events.length>0&&!g.value||f.value||(g.value=i.events.length===1?i.events[0].id:null))},ae=async()=>{var d;if(!v.value||!I.value){m.value={success:!1,message:"No booking or occurrence selected for check-in."};return}N.event_occurrence_id=I.value,t.value=!0;try{const a=await fetch(route("admin.qr-scanner.check-in"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,Accept:"application/json"},body:JSON.stringify(N.data())});if(a.status===204)m.value={success:!0,message:"Check-in successful!"},v.value&&(v.value.status="used"),await re();else{const x=await a.json();m.value={success:!1,message:x.message||"Check-in failed."}}}catch(a){console.error("Check-in error:",a),m.value={success:!1,message:a.message||"An unexpected error occurred during check-in."}}finally{t.value=!1}},re=async()=>{var d;if(v.value)try{const a=await fetch(route("admin.qr-scanner.validate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,Accept:"application/json"},body:JSON.stringify({qr_code:v.value.booking_number,event_id:g.value})}),x=await a.json();a.ok&&x.success&&(D.value=x.check_in_history,v.value=x.booking)}catch(a){console.error("Error refreshing check-in history:",a)}},ne=()=>{s.value=!1,y.value=!1,j()},oe=async()=>{if(typeof navigator>"u"||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera API not supported in this browser");return}try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})).getTracks().forEach(a=>{a.stop()}),alert("✅ Camera access test successful!")}catch(d){console.error("Camera access test failed:",d);let a="Camera access failed: ";switch(d.name){case"NotAllowedError":a+="Permission denied. Please allow camera access and try again.";break;case"NotFoundError":a+="No camera found. Please ensure a camera is connected.";break;case"NotReadableError":a+="Camera is in use by another application.";break;case"SecurityError":a+="Security error. Ensure you are on HTTPS.";break;default:a+=d.message||"Unknown error occurred."}alert(a)}};return ue(()=>{typeof window<"u"&&(V.value=window.location.protocol==="https:",z.value=window.isSecureContext,X.value=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),Z.value=window.location.href),!f.value&&i.events.length===1&&(g.value=i.events[0].id)}),ve(()=>{}),(d,a)=>(r(),n(H,null,[E(b(me),{title:"QR Code Scanner"}),E(xe,{title:"QR Code Scanner"},{default:R(()=>{var x,S;return[e("div",ct,[e("div",ut,[e("div",vt,[f.value&&b(i).events.length>0?(r(),n("div",mt,[a[2]||(a[2]=e("label",{for:"event-select",class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Select Event to Scan For: ",-1)),W(e("select",{id:"event-select","onUpdate:modelValue":a[0]||(a[0]=w=>g.value=w),class:"mt-1 block w-full rounded-md border-gray-300 py-2 pr-10 pl-3 text-base focus:border-indigo-500 focus:ring-indigo-500 focus:outline-none sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},[e("option",gt,o(C.value?"-- All Events (Platform Admin) --":"-- Select an Event --"),1),(r(!0),n(H,null,Q(b(i).events,w=>(r(),n("option",{key:w.id,value:w.id},o(w.name),9,kt))),128))],512),[[ge,g.value]]),!g.value&&f.value&&!C.value?(r(),n("p",yt," Admins: Please select an event to enable the scanner. ")):c("",!0),C.value?(r(),n("p",bt," Platform Admin: You can scan QR codes for any event. Optionally select a specific event to filter results. ")):c("",!0)])):!f.value&&b(i).events.length===0?(r(),n("div",ft,a[3]||(a[3]=[e("p",null," You are not currently an organizer for any published events. Please contact an administrator if you believe this is an error. ",-1)]))):c("",!0),e("div",pt,[e("div",ht,[h.value?(r(),n("div",xt,[p(o(h.value)+" ",1),h.value.includes("NotAllowedError")||h.value.includes("NotFoundError")?(r(),n("p",_t," Please grant camera permissions in your browser settings and ensure a camera is connected, then refresh the page. ")):c("",!0)])):c("",!0),!h.value&&P.value?(r(),ke(b(pe),{key:l.value,paused:Y.value,onDetect:ee,onError:te,onCameraOn:se,formats:["qr_code"],class:"h-full w-full"},{default:R(()=>[!_.value&&!h.value?(r(),n("div",wt,a[4]||(a[4]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"Initializing camera...",-1)]))):c("",!0)]),_:1},8,["paused"])):c("",!0),f.value&&!g.value&&b(i).events.length>0&&!C.value||!f.value&&b(i).events.length===0?(r(),n("div",Ct,[e("p",St,[f.value&&!g.value&&!C.value?(r(),n("span",Et,"Please select an event above to activate the QR scanner.")):c("",!0),!f.value&&b(i).events.length===0?(r(),n("span",Dt,"No events available for scanning.")):c("",!0)])])):c("",!0)]),e("div",It,[a[7]||(a[7]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Scan Status",-1)),e("div",$t,[a[5]||(a[5]=e("h4",{class:"mb-2 font-medium text-blue-900 dark:text-blue-100"},"Debug Info:",-1)),e("div",At,[e("div",null,"🔒 HTTPS: "+o(V.value?"Yes":"No"),1),e("div",null,"🎥 Camera API: "+o(X.value?"Available":"Not Available"),1),e("div",null,"🔐 Secure Context: "+o(z.value?"Yes":"No"),1),e("div",null,"👤 Role: "+o(b(i).user_role),1),e("div",null,"🛡️ Platform Admin: "+o(C.value?"Yes":"No"),1),e("div",null,"📅 Events: "+o(b(i).events.length),1),e("div",null,"🎯 Selected Event: "+o(g.value||"None"),1),e("div",null,"📷 Scanner Ready: "+o(_.value?"Yes":"No"),1),e("div",null,"❌ Camera Error: "+o(h.value?"Yes":"No"),1),e("div",null,"🔄 Should Show Scanner: "+o(P.value?"Yes":"No"),1)])]),t.value&&!k.value&&!v.value&&!m.value?(r(),n("div",Nt,a[6]||(a[6]=[e("svg",{class:"mr-3 -ml-1 h-5 w-5 animate-spin text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),p(" Processing QR code... ")]))):c("",!0),(x=k.value)!=null&&x.success?(r(),n("div",Rt,o(k.value.success),1)):c("",!0),(S=k.value)!=null&&S.error?(r(),n("div",Mt,o(k.value.error),1)):c("",!0),!v.value&&!k.value&&!t.value&&!m.value&&P.value?(r(),n("div",Pt," Point the camera at a QR code to scan. ")):!v.value&&!k.value&&!t.value&&!m.value&&!P.value?(r(),n("div",Tt,[f.value&&!g.value&&!C.value?(r(),n("span",Ot,"Select an event to begin scanning.")):!f.value&&b(i).events.length===0?(r(),n("span",Ft,"No events available for scanning.")):(r(),n("span",Ht,"Scanner is idle."))])):c("",!0)])]),e("div",Ut,[E(U,{onClick:oe,class:"bg-blue-600 hover:bg-blue-700"},{default:R(()=>a[8]||(a[8]=[p(" Test Camera Access ")])),_:1}),E(U,{onClick:j,disabled:t.value&&!s.value},{default:R(()=>a[9]||(a[9]=[p(" Reset Scanner ")])),_:1},8,["disabled"])])])])]),E(he,{show:y.value},null,8,["show"]),E(dt,{show:s.value,"booking-details":v.value,"check-in-history":D.value,"event-occurrences":A.value,"selected-occurrence-id":I.value,"check-in-status":m.value,"is-processing":t.value,"check-in-form-errors":b(N).errors,onClose:ne,onCheckIn:ae,"onUpdate:selectedOccurrenceId":a[1]||(a[1]=w=>I.value=w)},null,8,["show","booking-details","check-in-history","event-occurrences","selected-occurrence-id","check-in-status","is-processing","check-in-form-errors"])]}),_:1})],64))}});export{ns as default};
