import{d as q,a as n,i as c,o as r,z as le,c as H,f as e,g as h,t as o,j as O,e as b,F,r as V,b as E,w as A,k as W,B as ie,n as de,s as u,C as ce,D as ue,A as ve,x as ge,m as me,l as ke,h as ye}from"./app-CGQ0TI7Y.js";import{_ as be}from"./AuthLayout.vue_vue_type_script_setup_true_lang-DywILsm0.js";import{_ as U}from"./index-Df_9D6Ld.js";import{g as G,a as fe,d as he,i as pe}from"./qrcode-CiPJzAB6.js";import{d as L}from"./dayjs.min-Bzsuw0Fq.js";import{U as xe}from"./vue-qrcode-reader-Br23yDWc.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Yge9527i.js";import"./useToast-voWX6zgl.js";const _e={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center"},we=q({__name:"QRCodeLoadingModal",props:{show:{type:Boolean}},setup(Y){return(M,l)=>M.show?(r(),n("div",_e,l[0]||(l[0]=[le('<div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-xl max-w-md w-full mx-4"><div class="text-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"></div><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-2">Processing QR Code...</h3><p class="text-sm text-gray-500 dark:text-gray-400">Validating booking and checking usage history</p></div></div>',1)]))):c("",!0)}}),Ce={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Se={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800"},Ee={class:"mt-3"},Ie={class:"flex items-center justify-between mb-4"},De={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ae={class:"space-y-1 text-sm"},Ne={class:"space-y-1 text-sm"},Re={class:"bg-blue-50 dark:bg-blue-900 rounded-lg p-4 mb-4"},Me={class:"space-y-1 text-sm"},Pe={key:0},Te={key:0,class:"bg-yellow-50 dark:bg-yellow-900 rounded-lg p-4 mb-4"},Oe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},He={class:"text-center"},Fe={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Ue={class:"text-center"},Ye={class:"text-2xl font-bold text-red-600 dark:text-red-400"},je={class:"text-center"},Be={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Qe={class:"text-center"},Le={class:"text-2xl font-bold text-gray-600 dark:text-gray-400"},Ve={key:0,class:"space-y-2"},qe={class:"max-h-32 overflow-y-auto space-y-1"},ze={class:"flex items-center space-x-2"},Xe={class:"text-gray-600 dark:text-gray-400"},Ke={key:0,class:"text-gray-500 dark:text-gray-400 text-right"},Je={key:1,class:"text-sm text-gray-600 dark:text-gray-400"},Ge={key:1,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},We={class:"space-y-2 max-h-48 overflow-y-auto"},Ze=["value"],et={class:"ml-3 text-sm text-gray-700 dark:text-gray-200"},tt={class:"font-medium"},st={key:0,class:"block text-xs text-gray-500 dark:text-gray-400"},at={key:0,class:"text-xs text-red-500 mt-1"},rt={key:1,class:"text-xs text-yellow-600 mt-1"},nt={key:2,class:"bg-yellow-50 dark:bg-yellow-700 border border-yellow-300 dark:border-yellow-600 rounded-md text-sm text-yellow-700 dark:text-yellow-200 p-3"},ot={class:"flex justify-end space-x-3 p-5 border-t border-gray-200 dark:border-gray-700"},lt={key:0},it={key:1},dt={key:2},ct={key:3},ut=q({__name:"QRCodeBookingDetailsModal",props:{show:{type:Boolean},bookingDetails:{},checkInHistory:{},eventOccurrences:{},selectedOccurrenceId:{},checkInStatus:{},isProcessing:{type:Boolean},checkInFormErrors:{}},emits:["close","check-in","update:selectedOccurrenceId"],setup(Y,{emit:M}){const l=Y,_=H({get:()=>l.selectedOccurrenceId,set:t=>k("update:selectedOccurrenceId",t)}),k=M,v=t=>fe(t),N=(t,s)=>new Intl.NumberFormat("en-US",{style:"currency",currency:s||"USD"}).format(t/100),I=(t,s)=>{if(!t)return"Date TBD";const y=L(t),g=s?L(s):null;return g&&!y.isSame(g,"day")?`${y.format("MMM D, HH:mm")} - ${g.format("MMM D, HH:mm, YYYY")}`:y.format("MMM D, YYYY • HH:mm")},m=t=>L(t).format("MMM D, YYYY • HH:mm"),D=t=>{switch(t){case"SUCCESSFUL":return"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100";case"FAILED_MAX_USES_REACHED":return"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100";case"FAILED_ALREADY_USED":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100"}},p=t=>{switch(t){case"SUCCESSFUL":return"Successful";case"FAILED_MAX_USES_REACHED":return"Max Uses Reached";case"FAILED_ALREADY_USED":return"Already Used";case"FAILED_INVALID_CODE":return"Invalid Code";case"FAILED_NOT_YET_VALID":return"Not Yet Valid";case"FAILED_EXPIRED":return"Expired";default:return t}};return(t,s)=>{var y,g;return t.show&&t.bookingDetails?(r(),n("div",Ce,[e("div",Se,[e("div",Ee,[e("div",Ie,[s[5]||(s[5]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Booking Details",-1)),e("button",{onClick:s[0]||(s[0]=i=>t.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},s[4]||(s[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",De,[e("div",$e,[e("div",null,[s[10]||(s[10]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Booking Information",-1)),e("div",Ae,[e("div",null,[s[6]||(s[6]=e("span",{class:"font-medium"},"Booking #:",-1)),h(" "+o(t.bookingDetails.booking_number),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"font-medium"},"Status:",-1)),e("span",{class:O(v(t.bookingDetails.status))},o(b(G)(t.bookingDetails.status)),3)]),e("div",null,[s[8]||(s[8]=e("span",{class:"font-medium"},"Quantity:",-1)),h(" "+o(t.bookingDetails.quantity),1)]),e("div",null,[s[9]||(s[9]=e("span",{class:"font-medium"},"Total:",-1)),h(" "+o(N(t.bookingDetails.total_price,t.bookingDetails.currency)),1)])])]),e("div",null,[s[13]||(s[13]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Customer Information",-1)),e("div",Ne,[e("div",null,[s[11]||(s[11]=e("span",{class:"font-medium"},"Name:",-1)),h(" "+o(t.bookingDetails.user.name),1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"font-medium"},"Email:",-1)),h(" "+o(t.bookingDetails.user.email),1)])])])])]),e("div",Re,[s[16]||(s[16]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Event Information",-1)),e("div",Me,[e("div",null,[s[14]||(s[14]=e("span",{class:"font-medium"},"Event:",-1)),h(" "+o(t.bookingDetails.event.name),1)]),t.bookingDetails.ticket_definition?(r(),n("div",Pe,[s[15]||(s[15]=e("span",{class:"font-medium"},"Ticket Type:",-1)),h(" "+o(t.bookingDetails.ticket_definition.name),1)])):c("",!0)])]),t.checkInHistory?(r(),n("div",Te,[s[22]||(s[22]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-3"},"Check-in History & Usage",-1)),e("div",Oe,[e("div",He,[e("div",Fe,o(t.checkInHistory.successful_check_ins),1),s[17]||(s[17]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Successful",-1))]),e("div",Ue,[e("div",Ye,o(t.checkInHistory.failed_check_ins),1),s[18]||(s[18]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Failed",-1))]),e("div",je,[e("div",Be,o(t.checkInHistory.remaining_check_ins),1),s[19]||(s[19]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Remaining",-1))]),e("div",Qe,[e("div",Le,o(t.checkInHistory.max_allowed_check_ins),1),s[20]||(s[20]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Max Allowed",-1))])]),t.checkInHistory.check_in_logs.length>0?(r(),n("div",Ve,[s[21]||(s[21]=e("h5",{class:"font-medium text-gray-900 dark:text-gray-100 text-sm"},"Recent Check-in Attempts:",-1)),e("div",qe,[(r(!0),n(F,null,V(t.checkInHistory.check_in_logs.slice(0,5),i=>(r(),n("div",{key:i.id,class:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded text-xs"},[e("div",ze,[e("span",{class:O([D(i.status),"px-2 py-1 rounded-full text-xs font-medium"])},o(p(i.status)),3),e("span",Xe,o(m(i.timestamp)),1)]),i.event_occurrence?(r(),n("div",Ke,[e("div",null,o(i.event_occurrence.name||"Main Occurrence"),1)])):c("",!0)]))),128))])])):(r(),n("div",Je," No previous check-in attempts found. "))])):c("",!0),t.eventOccurrences.length>0?(r(),n("div",Ge,[s[24]||(s[24]=e("h5",{class:"font-medium text-gray-900 dark:text-gray-100 mb-2"},"Select Event Occurrence for Check-in:",-1)),e("div",We,[(r(!0),n(F,null,V(t.eventOccurrences,i=>(r(),n("label",{key:i.id,class:O(["flex items-center p-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors",{"bg-indigo-50 dark:bg-indigo-900 border border-indigo-500 dark:border-indigo-400":_.value===i.id}])},[W(e("input",{type:"radio",name:"event_occurrence",value:i.id,"onUpdate:modelValue":s[1]||(s[1]=P=>_.value=P),class:"form-radio h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-500 focus:ring-indigo-500"},null,8,Ze),[[ie,_.value]]),e("span",et,[e("span",tt,o(i.name||"Main Occurrence"),1),s[23]||(s[23]=e("br",null,null,-1)),h(" "+o(I(i.start_at,i.end_at))+" ",1),i.venue_name?(r(),n("span",st,"📍 "+o(i.venue_name),1)):c("",!0)])],2))),128))]),!_.value&&((y=t.checkInFormErrors)!=null&&y.event_occurrence_id)?(r(),n("p",at,o(t.checkInFormErrors.event_occurrence_id),1)):!_.value&&t.bookingDetails.status==="confirmed"&&!t.checkInStatus?(r(),n("p",rt,"Please select an occurrence to proceed with check-in.")):c("",!0)])):(r(),n("div",nt," No upcoming occurrences found for this event. Check-in may not be possible. ")),t.checkInStatus?(r(),n("div",{key:3,class:O(["mt-4 p-3 rounded-md text-sm",{"bg-green-50 dark:bg-green-700 border border-green-300 dark:border-green-600 text-green-700 dark:text-green-200":t.checkInStatus.success,"bg-red-50 dark:bg-red-700 border border-red-300 dark:border-red-600 text-red-700 dark:text-red-200":!t.checkInStatus.success}])},o(t.checkInStatus.message),3)):c("",!0)]),e("div",ot,[E(U,{variant:"outline",onClick:s[2]||(s[2]=i=>t.$emit("close"))},{default:A(()=>s[25]||(s[25]=[h("Cancel")])),_:1}),E(U,{variant:"default",onClick:s[3]||(s[3]=i=>t.$emit("check-in")),disabled:!_.value||t.isProcessing&&!t.checkInStatus||t.bookingDetails.status!=="confirmed"||((g=t.checkInStatus)==null?void 0:g.success)===!0},{default:A(()=>{var i;return[t.isProcessing&&!t.checkInStatus?(r(),n("span",lt,"Processing Check-in...")):((i=t.checkInStatus)==null?void 0:i.success)===!0?(r(),n("span",it,"Checked In")):t.bookingDetails.status!=="confirmed"?(r(),n("span",dt,"Cannot Check-In (Status: "+o(b(G)(t.bookingDetails.status))+")",1)):(r(),n("span",ct,"Confirm Check-in"))]}),_:1},8,["disabled"])])])])):c("",!0)}}}),vt={class:"py-12"},gt={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},mt={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg p-6"},kt={key:0,class:"mb-6"},yt={value:null},bt=["value"],ft={key:0,class:"text-sm text-yellow-600 mt-1"},ht={key:1,class:"text-sm text-blue-600 mt-1"},pt={key:1,class:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700"},xt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_t={class:"border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden relative aspect-square md:aspect-auto min-h-[300px]"},wt={key:0,class:"p-4 bg-red-100 text-red-700 text-sm"},Ct={key:0,class:"mt-1"},St={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700"},Et={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700"},It={class:"text-gray-500 dark:text-gray-400 text-center p-4"},Dt={key:0},$t={key:1},At={class:"space-y-4"},Nt={class:"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-md p-3 text-xs"},Rt={class:"space-y-1 text-blue-800 dark:text-blue-200"},Mt={key:0,class:"flex items-center text-sm text-gray-600 dark:text-gray-400"},Pt={key:1,class:"p-3 bg-green-50 dark:bg-green-700 border border-green-300 dark:border-green-600 rounded-md text-sm text-green-700 dark:text-green-200"},Tt={key:2,class:"p-3 bg-red-50 dark:bg-red-700 border border-red-300 dark:border-red-600 rounded-md text-sm text-red-700 dark:text-red-200"},Ot={key:3,class:"text-sm text-gray-500 dark:text-gray-400"},Ht={key:4,class:"text-sm text-gray-500 dark:text-gray-400"},Ft={key:0},Ut={key:1},Yt={key:2},jt={class:"mt-6 flex justify-between"},Jt=q({__name:"Index",setup(Y){var J;const l=de().props,_=u(!1),k=u(null),v=u(null),N=u([]),I=u(null),m=u(null),D=u(null),p=u(null),t=u(!1),s=u(!1),y=u(!1),g=u(null),i=u(0),P=u(null),j=u(!1),z=u(!1),X=u(!1),K=u(!1),Z=u(""),f=H(()=>l.user_role==="admin"),C=H(()=>l.user_role==="admin"),T=H(()=>C.value?!0:!f.value&&l.events.length>0?l.events.length===1||m.value!==null:!1),R=ce({qr_code_identifier:"",event_occurrence_id:null,method:"QR_SCAN",operator_user_id:(J=l.auth.user)==null?void 0:J.id});ue(m,(d,a)=>{B()});const ee=async d=>{var x;if(t.value||d.length===0)return;const a=d[0].rawValue;y.value=!0,t.value=!0,k.value=null,v.value=null,N.value=[],I.value=null,g.value=null;try{let S=a;try{const Q=he(a);if(!pe(Q,24*30)){k.value={error:"QR code has expired or is invalid."},y.value=!1,t.value=!1;return}S=Q.bookingNumber}catch{S=a}P.value=a;const w=await fetch(route("admin.qr-scanner.validate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content,Accept:"application/json"},body:JSON.stringify({qr_code:S,event_id:m.value})}),$=await w.json();w.ok&&$.success?(v.value=$.booking,N.value=$.event_occurrences,I.value=$.check_in_history,k.value={success:`Booking ${$.booking.booking_number} found.`},R.qr_code_identifier=$.booking.booking_number,y.value=!1,s.value=!0):(k.value={error:$.message||"Failed to validate QR code."},v.value=null,y.value=!1)}catch(S){console.error("Error processing QR code:",S),k.value={error:S.message||"Error processing QR code."},v.value=null,y.value=!1}finally{t.value=!1}},te=d=>{let a=`Camera error: ${d.name}`;switch(d.name){case"NotAllowedError":a="Camera access denied. Please allow camera access in your browser settings and refresh the page.";break;case"NotFoundError":a="No camera found. Please ensure a camera is connected to your device.";break;case"NotReadableError":a="Camera is already in use by another application. Please close other apps using the camera.";break;case"OverconstrainedError":a="Camera constraints could not be satisfied. Try refreshing the page.";break;case"SecurityError":a="Camera access blocked due to security restrictions. Ensure you are on HTTPS.";break;case"AbortError":a="Camera access was aborted. Please try again.";break;default:a=`Camera error: ${d.name}. ${d.message||"Please ensure camera access is allowed."}`}p.value=a},se=()=>{_.value=!0,p.value=null},B=async()=>{k.value=null,v.value=null,N.value=[],I.value=null,D.value=null,g.value=null,t.value=!1,s.value=!1,y.value=!1,P.value=null,p.value=null,j.value=!0,await new Promise(d=>setTimeout(d,100)),j.value=!1,R.reset(),R.qr_code_identifier="",!C.value&&(f.value&&l.events.length>0&&!m.value||f.value||(m.value=l.events.length===1?l.events[0].id:null))},ae=async()=>{var d;if(!v.value||!D.value){g.value={success:!1,message:"No booking or occurrence selected for check-in."};return}R.event_occurrence_id=D.value,t.value=!0;try{const a=await fetch(route("admin.qr-scanner.check-in"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,Accept:"application/json"},body:JSON.stringify(R.data())});if(a.status===204)g.value={success:!0,message:"Check-in successful!"},v.value&&(v.value.status="used"),await re();else{const x=await a.json();g.value={success:!1,message:x.message||"Check-in failed."}}}catch(a){console.error("Check-in error:",a),g.value={success:!1,message:a.message||"An unexpected error occurred during check-in."}}finally{t.value=!1}},re=async()=>{var d;if(v.value)try{const a=await fetch(route("admin.qr-scanner.validate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,Accept:"application/json"},body:JSON.stringify({qr_code:v.value.booking_number,event_id:m.value})}),x=await a.json();a.ok&&x.success&&(I.value=x.check_in_history,v.value=x.booking)}catch(a){console.error("Error refreshing check-in history:",a)}},ne=()=>{s.value=!1,y.value=!1,B()},oe=async()=>{if(typeof navigator>"u"||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera API not supported in this browser");return}try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})).getTracks().forEach(a=>{a.stop()}),alert("✅ Camera access test successful!")}catch(d){console.error("Camera access test failed:",d);let a="Camera access failed: ";switch(d.name){case"NotAllowedError":a+="Permission denied. Please allow camera access and try again.";break;case"NotFoundError":a+="No camera found. Please ensure a camera is connected.";break;case"NotReadableError":a+="Camera is in use by another application.";break;case"SecurityError":a+="Security error. Ensure you are on HTTPS.";break;default:a+=d.message||"Unknown error occurred."}alert(a)}};return ve(()=>{typeof window<"u"&&(z.value=window.location.protocol==="https:",X.value=window.isSecureContext,K.value=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),Z.value=window.location.href),!f.value&&l.events.length===1&&(m.value=l.events[0].id)}),ge(()=>{}),(d,a)=>(r(),n(F,null,[E(b(me),{title:"QR Code Scanner"}),E(be,{title:"QR Code Scanner"},{header:A(()=>a[2]||(a[2]=[e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," QR Code Scanner ",-1)])),default:A(()=>{var x,S;return[e("div",vt,[e("div",gt,[e("div",mt,[f.value&&b(l).events.length>0?(r(),n("div",kt,[a[3]||(a[3]=e("label",{for:"event-select",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Select Event to Scan For: ",-1)),W(e("select",{id:"event-select","onUpdate:modelValue":a[0]||(a[0]=w=>m.value=w),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[e("option",yt,o(C.value?"-- All Events (Platform Admin) --":"-- Select an Event --"),1),(r(!0),n(F,null,V(b(l).events,w=>(r(),n("option",{key:w.id,value:w.id},o(w.name),9,bt))),128))],512),[[ke,m.value]]),!m.value&&f.value&&!C.value?(r(),n("p",ft," Admins: Please select an event to enable the scanner. ")):c("",!0),C.value?(r(),n("p",ht," Platform Admin: You can scan QR codes for any event. Optionally select a specific event to filter results. ")):c("",!0)])):!f.value&&b(l).events.length===0?(r(),n("div",pt,a[4]||(a[4]=[e("p",null,"You are not currently an organizer for any published events. Please contact an administrator if you believe this is an error.",-1)]))):c("",!0),e("div",xt,[e("div",_t,[p.value?(r(),n("div",wt,[h(o(p.value)+" ",1),p.value.includes("NotAllowedError")||p.value.includes("NotFoundError")?(r(),n("p",Ct," Please grant camera permissions in your browser settings and ensure a camera is connected, then refresh the page. ")):c("",!0)])):c("",!0),!p.value&&T.value?(r(),ye(b(xe),{key:i.value,paused:j.value,onDetect:ee,onError:te,onCameraOn:se,formats:["qr_code"],class:"w-full h-full"},{default:A(()=>[!_.value&&!p.value?(r(),n("div",St,a[5]||(a[5]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"Initializing camera...",-1)]))):c("",!0)]),_:1},8,["paused"])):c("",!0),f.value&&!m.value&&b(l).events.length>0&&!C.value||!f.value&&b(l).events.length===0?(r(),n("div",Et,[e("p",It,[f.value&&!m.value&&!C.value?(r(),n("span",Dt,"Please select an event above to activate the QR scanner.")):c("",!0),!f.value&&b(l).events.length===0?(r(),n("span",$t,"No events available for scanning.")):c("",!0)])])):c("",!0)]),e("div",At,[a[8]||(a[8]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Scan Status",-1)),e("div",Nt,[a[6]||(a[6]=e("h4",{class:"font-medium text-blue-900 dark:text-blue-100 mb-2"},"Debug Info:",-1)),e("div",Rt,[e("div",null,"🔒 HTTPS: "+o(z.value?"Yes":"No"),1),e("div",null,"🎥 Camera API: "+o(K.value?"Available":"Not Available"),1),e("div",null,"🔐 Secure Context: "+o(X.value?"Yes":"No"),1),e("div",null,"👤 Role: "+o(b(l).user_role),1),e("div",null,"🛡️ Platform Admin: "+o(C.value?"Yes":"No"),1),e("div",null,"📅 Events: "+o(b(l).events.length),1),e("div",null,"🎯 Selected Event: "+o(m.value||"None"),1),e("div",null,"📷 Scanner Ready: "+o(_.value?"Yes":"No"),1),e("div",null,"❌ Camera Error: "+o(p.value?"Yes":"No"),1),e("div",null,"🔄 Should Show Scanner: "+o(T.value?"Yes":"No"),1)])]),t.value&&!k.value&&!v.value&&!g.value?(r(),n("div",Mt,a[7]||(a[7]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),h(" Processing QR code... ")]))):c("",!0),(x=k.value)!=null&&x.success?(r(),n("div",Pt,o(k.value.success),1)):c("",!0),(S=k.value)!=null&&S.error?(r(),n("div",Tt,o(k.value.error),1)):c("",!0),!v.value&&!k.value&&!t.value&&!g.value&&T.value?(r(),n("div",Ot," Point the camera at a QR code to scan. ")):!v.value&&!k.value&&!t.value&&!g.value&&!T.value?(r(),n("div",Ht,[f.value&&!m.value&&!C.value?(r(),n("span",Ft,"Select an event to begin scanning.")):!f.value&&b(l).events.length===0?(r(),n("span",Ut,"No events available for scanning.")):(r(),n("span",Yt,"Scanner is idle."))])):c("",!0)])]),e("div",jt,[E(U,{onClick:oe,class:"bg-blue-600 hover:bg-blue-700"},{default:A(()=>a[9]||(a[9]=[h(" Test Camera Access ")])),_:1}),E(U,{onClick:B,disabled:t.value&&!s.value},{default:A(()=>a[10]||(a[10]=[h(" Reset Scanner ")])),_:1},8,["disabled"])])])])]),E(we,{show:y.value},null,8,["show"]),E(ut,{show:s.value,"booking-details":v.value,"check-in-history":I.value,"event-occurrences":N.value,"selected-occurrence-id":D.value,"check-in-status":g.value,"is-processing":t.value,"check-in-form-errors":b(R).errors,onClose:ne,onCheckIn:ae,"onUpdate:selectedOccurrenceId":a[1]||(a[1]=w=>D.value=w)},null,8,["show","booking-details","check-in-history","event-occurrences","selected-occurrence-id","check-in-status","is-processing","check-in-form-errors"])]}),_:1})],64))}});export{Jt as default};
