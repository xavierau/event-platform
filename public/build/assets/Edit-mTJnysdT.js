import{d as w,C,c as z,s as N,x as U,a as d,o as i,b as x,e as o,m as T,w as b,f as t,p as V,i as l,k as m,v as y,t as u,F as v,r as P,l as S,q as W,P as G,g as I,j}from"./app-CBcdSYGl.js";import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-Cykr0hji.js";import"./index-BH95GTik.js";import"./index-B_RuNNQq.js";import"./useForwardPropsEmits-BUmNaTt4.js";import"./useForwardExpose-2b0zYAwj.js";import"./useFocusGuards-BRQO_hst.js";import"./Teleport-BsQYp6hP.js";import"./VisuallyHidden-dajNmunB.js";import"./UserMenuContent.vue_vue_type_script_setup_true_lang-CPh5rXLj.js";import"./RovingFocusGroup-3mJjWm0y.js";import"./createLucideIcon-dtD6wVEP.js";import"./x-Br0THnaC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C3rar4t_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useToast-C_yoBaOs.js";const F={class:"py-12"},M={class:"max-w-3xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},E={class:"p-6 text-gray-900 dark:text-gray-100"},L={class:"space-y-6"},O={class:"border dark:border-gray-700 p-4 rounded-md"},J={class:"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-2"},D={key:0,class:"text-sm text-red-600 dark:text-red-400 mt-1"},$={key:1,class:"text-sm text-red-600 dark:text-red-400 mt-1"},q={key:2,class:"text-sm text-red-600 dark:text-red-400 mt-1"},A={key:3,class:"text-sm text-red-600 dark:text-red-400 mt-1"},H={key:0,class:"text-sm text-red-600 dark:text-red-400"},K=["value"],Q={key:0,class:"text-sm text-red-600 dark:text-red-400"},X={key:0,class:"mt-2 mb-4"},Y={class:"flex items-center space-x-4"},Z={class:"relative group"},ee=["src"],te={key:1,class:"mt-2 mb-4"},re={key:2,class:"mt-2 mb-4"},oe={class:"flex items-center space-x-4"},ae=["src"],se={key:3,class:"text-sm text-red-600 dark:text-red-400 mt-1"},de={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ie={key:0},ne={key:1},le={key:2},ge={class:"flex items-center"},ue={key:0,class:"text-sm text-red-600 dark:text-red-400"},me={class:"mt-8 flex justify-end"},ce=["disabled"],Pe=w({__name:"Edit",props:{category:{},categoriesForSelect:{}},setup(k){const n=k;console.log("Category data from backend:",n.category);const r=C({id:n.category.id,name:JSON.parse(JSON.stringify(n.category.name)),slug:n.category.slug,parent_id:n.category.parent_id,is_active:n.category.is_active,uploaded_icon:null,remove_icon:!1}),c=z(()=>{if(r.remove_icon)return null;if(n.category.media){const a=n.category.media.find(e=>e.collection_name==="icon");return(a==null?void 0:a.original_url)||null}return null}),p=()=>{r.remove_icon=!0,r.uploaded_icon=null,g.value=null},g=N(null),_=a=>{const e=a.target;if(e.files&&e.files[0]){r.uploaded_icon=e.files[0],r.remove_icon=!1;const s=e.files[0];s.type.startsWith("image/")&&(g.value=URL.createObjectURL(s))}else r.uploaded_icon=null,g.value=null},h=()=>{n.category.id&&(console.log("Form data being submitted:",r.data()),r.transform(a=>{const e={...a,_method:"PUT",name:{en:a.name.en||"","zh-TW":a.name["zh-TW"]||"","zh-CN":a.name["zh-CN"]||""},remove_icon:!!a.remove_icon};return console.log("Transformed data:",e),e}).post(route("admin.categories.update",n.category.id),{}))},f=(a,e,s="en")=>a?typeof a=="string"?a:a[e]||a[s]||Object.values(a)[0]||"":"";return U(()=>{g.value&&URL.revokeObjectURL(g.value)}),(a,e)=>(i(),d(v,null,[x(o(T),{title:`Edit Category: ${f(n.category.name,"en")}`},null,8,["title"]),x(B,null,{default:b(()=>[t("div",F,[t("div",M,[t("div",R,[t("div",E,[t("form",{onSubmit:V(h,["prevent"])},[t("div",L,[t("fieldset",O,[e[9]||(e[9]=t("legend",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 px-1"},"Category Name (Translatable)",-1)),t("div",J,[t("div",null,[e[6]||(e[6]=t("label",{for:"name_en",class:"block text-xs font-medium text-gray-700 dark:text-gray-400"},"English",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>o(r).name.en=s),id:"name_en",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"},null,512),[[y,o(r).name.en]])]),t("div",null,[e[7]||(e[7]=t("label",{for:"name_zh_TW",class:"block text-xs font-medium text-gray-700 dark:text-gray-400"},"Traditional Chinese",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>o(r).name["zh-TW"]=s),id:"name_zh_TW",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"},null,512),[[y,o(r).name["zh-TW"]]])]),t("div",null,[e[8]||(e[8]=t("label",{for:"name_zh_CN",class:"block text-xs font-medium text-gray-700 dark:text-gray-400"},"Simplified Chinese",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>o(r).name["zh-CN"]=s),id:"name_zh_CN",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"},null,512),[[y,o(r).name["zh-CN"]]])])]),o(r).errors.name?(i(),d("div",D,u(o(r).errors.name),1)):l("",!0),o(r).errors["name.en"]?(i(),d("div",$,u(o(r).errors["name.en"]),1)):l("",!0),o(r).errors["name.zh-TW"]?(i(),d("div",q,u(o(r).errors["name.zh-TW"]),1)):l("",!0),o(r).errors["name.zh-CN"]?(i(),d("div",A,u(o(r).errors["name.zh-CN"]),1)):l("",!0)]),t("div",null,[e[10]||(e[10]=t("label",{for:"slug",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Slug",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>o(r).slug=s),id:"slug",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"},null,512),[[y,o(r).slug]]),o(r).errors.slug?(i(),d("div",H,u(o(r).errors.slug),1)):l("",!0)]),t("div",null,[e[12]||(e[12]=t("label",{for:"parent_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Parent Category",-1)),m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(r).parent_id=s),id:"parent_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"},[e[11]||(e[11]=t("option",{value:null},"-- No Parent --",-1)),(i(!0),d(v,null,P(n.categoriesForSelect,s=>(i(),d("option",{key:s.id,value:s.id},u(f(s.name,"en")),9,K))),128))],512),[[S,o(r).parent_id]]),o(r).errors.parent_id?(i(),d("div",Q,u(o(r).errors.parent_id),1)):l("",!0)]),t("div",null,[e[18]||(e[18]=t("label",{for:"uploaded_icon",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Category Icon",-1)),c.value&&!g.value?(i(),d("div",X,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},"Current Icon:",-1)),t("div",Y,[t("div",Z,[t("img",{src:c.value,alt:"Current category icon",class:"w-16 h-16 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,ee),t("button",{type:"button",onClick:p,class:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 text-xs leading-none opacity-75 group-hover:opacity-100 transition-opacity","aria-label":"Remove icon",title:"Remove current icon"}," Ã— ")]),t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},[e[13]||(e[13]=t("p",null,"Current icon will be replaced when you upload a new one",-1)),t("button",{type:"button",onClick:p,class:"text-red-600 hover:text-red-800 text-xs mt-1 underline"}," Remove current icon ")])])])):l("",!0),o(r).remove_icon&&!g.value&&!c.value?(i(),d("div",te,e[15]||(e[15]=[t("div",{class:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md p-3"},[t("div",{class:"flex"},[t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),t("div",{class:"ml-3"},[t("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," Current icon will be removed when you save. Upload a new icon below if needed. ")])])],-1)]))):l("",!0),g.value?(i(),d("div",re,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},"New Icon Preview:",-1)),t("div",oe,[t("img",{src:g.value,alt:"New category icon preview",class:"w-16 h-16 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,ae),e[16]||(e[16]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},[t("p",null,"This will replace the current icon when you save")],-1))])])):l("",!0),t("input",{type:"file",onChange:_,id:"uploaded_icon",accept:"image/*",class:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 dark:file:bg-indigo-900 dark:file:text-indigo-300 dark:hover:file:bg-indigo-800"},null,32),o(r).errors.uploaded_icon?(i(),d("div",se,u(o(r).errors.uploaded_icon),1)):l("",!0),t("p",de,[c.value&&!o(r).remove_icon?(i(),d("span",ie,"Upload a new icon to replace the existing one, or use the remove button above")):o(r).remove_icon?(i(),d("span",ne,"Upload a new icon for this category (JPEG, PNG, WebP, GIF, SVG - max 2MB)")):(i(),d("span",le,"Upload an icon for this category (JPEG, PNG, WebP, GIF, SVG - max 2MB)"))])]),t("div",ge,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>o(r).is_active=s),id:"is_active",class:"h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-700 dark:bg-gray-900 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded"},null,512),[[W,o(r).is_active]]),e[19]||(e[19]=t("label",{for:"is_active",class:"ml-2 block text-sm text-gray-900 dark:text-gray-100"},"Active",-1))]),o(r).errors.is_active?(i(),d("div",ue,u(o(r).errors.is_active),1)):l("",!0)]),t("div",me,[x(o(G),{href:a.route("admin.categories.index"),class:"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 mr-4 py-2 px-4 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 transition ease-in-out duration-150"},{default:b(()=>e[20]||(e[20]=[I("Cancel")])),_:1},8,["href"]),t("button",{type:"submit",disabled:o(r).processing,class:j(["inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-500 active:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition ease-in-out duration-150",{"opacity-25":o(r).processing}])}," Update Category ",10,ce)])],32)])])])])]),_:1})],64))}});export{Pe as default};
